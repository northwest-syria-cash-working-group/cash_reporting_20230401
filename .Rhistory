arabic_labels <- function(x) paste0("\u202b", x)
report_date <- "11 April 2023"
names_eq <- c(
"date",
"governorate",
"district",
"sub_district",
"community",
"admin4",
"casualties",
"injuries",
"completely_destroyed_houses",
"damaged_unihabitable_houses",
"temporary_accommodation_centres",
"idps_in_all_centres",
"schools_as_accomodation_centres",
"idps_in_schools",
"tents_needed",
"blankets_mattresses_needed",
"temporary_accommodation_centres_available",
"accessible_civil_defense",
"latrines_available",
"meals_needed_per_day",
"need_blood_donations",
"health_services_available",
"necessary_medical_equipment",
"rubble_volunteers",
"telecoms_available",
"electricity_available",
"heating_fuel_needed"
)
eq <- read_excel("./data/syria-earthquake-impact-20-march-2023.xlsx",
sheet = "DATASET") %>%
setNames(names_eq) %>%
left_join(locations %>% select(admin4pcode, admin3pcode),
by = c("admin4" = "admin4pcode")) %>%
mutate(wounded_dead = casualties + injuries,
damaged_houses = completely_destroyed_houses + damaged_unihabitable_houses) %>%
group_by(admin3pcode) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
left_join(read_excel("./data/2023HNO_PiN_Severity_detailedAoI_FORSHARE 15032023.xlsx", skip = 1,
sheet = 1) %>%
clean_names() %>%
select(admin3pcode, total_population),
by = "admin3pcode") %>%
mutate(wounded_dead_100k = wounded_dead / total_population * 100000,
damaged_houses_100k = damaged_houses / total_population * 100000)
eq_mdepriv <- eq %>%
mutate_at(vars(wounded_dead, damaged_houses,
wounded_dead_100k, damaged_houses_100k), ~ range_wna(.)) %>%
mdepriv(c("wounded_dead", "damaged_houses",
"wounded_dead_100k", "damaged_houses_100k"),
method = "cz", output = "all",
score_i_heading = "eq_score")
eq <- eq %>%
left_join(eq_mdepriv$data %>%
select(admin3pcode, eq_score),
by = "admin3pcode")
# Think of another way to do this -- if someone else runs this, it won't work
cbr <- read_csv("./data/cbr_com.csv") %>%
mutate(month = month(distribution_date)) %>%
replace_na(list(beneficiaries = 0))
hno <- read_excel("./data/2023HNO_PiN_Severity_detailedAoI_FORSHARE 15032023.xlsx", skip = 1,
sheet = 1) %>%
clean_names()
nw_pcode3 <- hno %>%
filter(ao_c == "NW") %>%
pull(admin3pcode)
paste(format(round((cbr %>% filter(project_status == "Completed") %>%  {sum(.$total_usd)}) / 1000000, 1), trim = TRUE), "million")
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(i = 1, j = 3:6, part = "header",
as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(i = 1, j = 3:5, part = "header",
as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(j = 3:6, part = "header",
as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(i = 1, j = 1, part = "header",
as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons")
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header",
as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", inline = TRUE, i = 1, j = 1:3,
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 3:6,
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 3:5,
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 3:4,
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 1,
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 1:3,
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 3:6, inline = TRUE, ref_symbols = "1"
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
eq %>%
left_join(hno %>%
select(governorate = admin1name_en,
district = admin2name_en,
sub_district = admin3name_en,
admin3pcode),
by = "admin3pcode") %>%
filter(admin3pcode %in% nw_pcode3 &
district %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(governorate, district) %>%
summarise(wounded_dead = sum(wounded_dead, na.rm = TRUE),
damaged_houses = sum(damaged_houses, na.rm = TRUE)) %>%
# Where is Ariha, and why is it showing up here
filter(district != "Ariha") %>%
left_join(hno %>%
filter(admin3pcode %in% nw_pcode3 &
admin2name_en %in% c("Harim", "Idleb", "Jisr-Ash-Shugur",
"Afrin", "Jebel Saman", "A'zaz", "Jarablus", "Al Bab")) %>%
group_by(district = admin2name_en) %>%
summarise(population = sum(total_population, na.rm = TRUE)), by = "district") %>%
mutate(wounded_dead_100k = round(wounded_dead / population * 100000, digits = 2),
damaged_houses_100k = round(damaged_houses / population * 100000, digits = 2)) %>%
select(governorate, district, wounded_dead, wounded_dead_100k,
damaged_houses, damaged_houses_100k) %>%
flextable() %>%
theme_zebra() %>%
set_table_properties(layout = "autofit", width = .99) %>%
set_caption("Casualties and damaged houses, absolute figures and per 100,000 persons") %>%
footnote(part = "header", i = 1, j = 3:6, inline = TRUE, ref_symbols = "1",
value = as_paragraph("Data from the Assistance Coordination Unit, Syria 20230328"))
br %>% filter(project_status == "Completed") %>% {sum(.$beneficiaries)} %>% format(big.mark = ",")
cbr %>% filter(project_status == "Completed") %>% {sum(.$beneficiaries)} %>% format(big.mark = ",")
r cbr %>% filter(project_status == "Completed") %>% {sum(.$families)} %>% format(big.mark = ",")
cbr %>% filter(project_status == "Completed") %>% {sum(.$families)} %>% format(big.mark = ",")
cbr %>% filter(project_status == "Completed") %>% {sum(.$families, na.rm = TRUE)} %>% format(big.mark = ",")
paste(format(round((cbr %>% filter(project_status == "Completed") %>%  {sum(.$total_usd)}) / 1000000, 1), trim = TRUE), "million")
cbr %>% filter(project_status == "Completed") %>% summarise(n_distinct(implementing_partner)) %>% pull()
cbr %>% filter(project_status == "Completed") %>% summarise(n_distinct(admin3pcode)) %>% pull()
filter(cbr, month == 2 & project_status == "Completed") %>% {sum(.$beneficiaries, na.rm = TRUE)} %>% format(big.mark = ",")
filter(cbr, month == 3 & project_status == "Completed") %>% {sum(.$beneficiaries, na.rm = TRUE)} %>% format(big.mark = ",")
