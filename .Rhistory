filter(men_18_60 != .13 & women_18_60 != .27)
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13 & women_18_60 != .27) %>%
nrow()
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13 & women_18_60 != .27)
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13 & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram()
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13 & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
scale_x_log10()
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13 & women_18_60 != .27) %>%
count(men_18_60, sort = TRUE)
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
adorn_pct_formatting(digits = 2)
filter(men_18_60 != "13.00%"  & women_18_60 != "27.00%") %>%
count(men_18_60, sort = TRUE)
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
adorn_pct_formatting(digits = 2) %>%
filter(men_18_60 != "13.00%"  & women_18_60 != "27.00%") %>%
count(men_18_60, sort = TRUE)
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
adorn_pct_formatting(digits = 2) %>%
filter(men_18_60 != "13.00%"  & women_18_60 != "27.00%") %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
scale_x_log10()
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
scale_x_log10()
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
hno %>% glimpse()
hno %>%
filter(ao_c == "NW") %>%
ggplot(aes(x = male_percent)) +
geom_histogram()
hno %>%
filter(ao_c == "NW") %>%
ggplot(aes(x = male_percent)) +
geom_histogram() +
scale_x_log10()
hno %>%
filter(ao_c == "NW") %>%
ggplot(aes(x = male_percent)) +
geom_histogram(binwidth = 1) +
scale_x_log10()
hno %>%
filter(ao_c == "NW") %>%
ggplot(aes(x = male_percent)) +
geom_histogram(binwidth = 2) +
scale_x_log10()
hno %>%
filter(ao_c == "NW") %>%
ggplot(aes(x = male_percent)) +
geom_histogram(binwidth = ;1) +
hno %>%
filter(ao_c == "NW") %>%
ggplot(aes(x = male_percent)) +
geom_histogram(binwidth = .1) +
scale_x_log10()
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram() +
scale_x_log10()
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
scale_x_log10()
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
geom_freqpoly(binwidth = .2,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
geom_freqpoly(binwidth = 2,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
geom_freqpoly(binwidth = .002,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram() +
geom_freqpoly(binwidth = .02,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .02,
colour = "red",
alpha = .7) +
scale_x_log10()
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .002,
colour = "red",
alpha = .7) +
scale_x_log10()
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .005,
colour = "red",
alpha = .7) +
scale_x_log10()
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .004,
colour = "red",
alpha = .7) +
scale_x_log10()
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .01,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 30) +
geom_freqpoly(binwidth = .01,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .02,
colour = "red",
alpha = .7) +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .007,
colour = "red",
alpha = .5) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_freqpoly(binwidth = .005,
colour = "red",
alpha = .5) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
hno %>%
ggplot(aes(x = male_percent)) +
geom_histogram(bins = 50) +
geom_density() +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
hno %>%
ggplot(aes(x = male_percent)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
hno %>%
ggplot(aes(x = male_percent)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .7) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
hno %>%
ggplot(aes(x = male_percent)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10() +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10() +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
hno %>%
ggplot(aes(x = male_percent)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10(labels = percent) +
labs(title = "Normal distribution of men as percentage of PIN in Syria",
x = "% of men",
y = "Number of sub-districts")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
ggplot(aes(x = men_18_60)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10(labels = percent) +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "% of men",
y = "Number of rows")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
mutate(pc_male = men_18_60 + boys_18) +
ggplot(aes(x = male_pc)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10(labels = percent) +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "Males as % of total",
y = "Number of rows")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
mutate(pc_male = men_18_60 + boys_18)  %>%
ggplot(aes(x = male_pc)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10(labels = percent) +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "Males as % of total",
y = "Number of rows")
four %>%
filter(!is.na(men_18_60) | !is.na(women_18_60) | !is.na(boys_18) | !is.na(girls_18)) %>%
select(beneficiaries, men_18_60, women_18_60, boys_18, girls_18) %>%
adorn_percentages("row") %>%
filter(men_18_60 != .13  & women_18_60 != .27) %>%
mutate(pc_male = men_18_60 + boys_18)  %>%
ggplot(aes(x = pc_male)) +
geom_density(colour = "blue", alpha = .7) +
geom_histogram(bins = 50, alpha = .8) +
scale_x_log10(labels = percent) +
labs(title = "Abnormal distribution of men as percentage of individuals reached",
x = "Males as % of total",
y = "Number of rows")
four %>% filter(project_status == "Completed") %>% filter(!is.na(elderly_females_60 | !is.na(elderly_males_60)) %>% nrow()
cbr %>% count(source)
cbr %>% count(source)
cbr %>% filter(source == "fsl_tracker")
cbr %>%
filter(project_status == "Completed") %>%
group_by(governorate, district) %>%
summarise(partners = n_distinct(implementing_partner),
communities = n_distinct(admin4pcode),
households = sum(families, na.rm = TRUE),
beneficiaries = sum(beneficiaries, na.rm = TRUE),
total_usd = sum(total_usd, na.rm = TRUE)) %>%
ungroup() %>%
mutate(`%_BNF` =
round(beneficiaries / sum(beneficiaries, na.rm = TRUE) * 100, digits = 2)) %>%
adorn_totals("row",,,, households, beneficiaries, total_usd, `%_BNF`) %>%
mutate(`%_BNF` = ifelse(`%_BNF` > 99.98, 100, `%_beneficiaries`)) %>%
select(governorate, district, communities, partners,
households, beneficiaries, total_usd, `%_BNF`) %>%
flextable() %>%
set_caption(paste0("448,000 people reached with MPC, USD 13.3 million disbursed, ", report_date)) %>%
theme_zebra() %>%
#  footnote(i = 1, j = 6, part = "header", ref_symbols = "a",
#           as_paragraph("Beneficiary figures include only reported MPC with a minimum transfer value #of USD 100")) %>%
footnote(i = 1, j = 8, part = "header", ref_symbols = "b", inline = TRUE,
as_paragraph("As percentage of all MPC beneficiaries reached in NW Syria"))
cbr %>%
filter(project_status == "Completed") %>%
group_by(governorate, district) %>%
summarise(partners = n_distinct(implementing_partner),
communities = n_distinct(admin4pcode),
households = sum(families, na.rm = TRUE),
beneficiaries = sum(beneficiaries, na.rm = TRUE),
total_usd = sum(total_usd, na.rm = TRUE)) %>%
ungroup() %>%
mutate(`%_BNF` =
round(beneficiaries / sum(beneficiaries, na.rm = TRUE) * 100, digits = 2)) %>%
adorn_totals("row",,,, households, beneficiaries, total_usd, `%_BNF`) %>%
mutate(`%_BNF` = ifelse(`%_BNF` > 99.98, 100, `%_BNF`)) %>%
select(governorate, district, communities, partners,
households, beneficiaries, total_usd, `%_BNF`) %>%
flextable() %>%
set_caption(paste0("448,000 people reached with MPC, USD 13.3 million disbursed, ", report_date)) %>%
theme_zebra() %>%
#  footnote(i = 1, j = 6, part = "header", ref_symbols = "a",
#           as_paragraph("Beneficiary figures include only reported MPC with a minimum transfer value #of USD 100")) %>%
footnote(i = 1, j = 8, part = "header", ref_symbols = "b", inline = TRUE,
as_paragraph("As percentage of all MPC beneficiaries reached in NW Syria"))
cbr %>% filter(project_status == "Planned") %>%
count(distribution_date)
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE))
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE))
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1",
value = as_paragraph("Some dates are missing or improperly encoded"))
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1",
value = as_paragraph("Some dates are missing or improperly encoded")) %>%
set_table_properties(layout = "autofit", width = .6)
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1", part = "header",
value = as_paragraph("Some dates are missing or improperly encoded")) %>%
set_table_properties(layout = "autofit", width = .6)
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
replace_na(list(month = "NA")) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1", part = "header",
value = as_paragraph("Some dates are missing or improperly encoded")) %>%
set_table_properties(layout = "autofit", width = .6)
cbr %>%
filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month, implementing_partner) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE))
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(month = case_when(month == "Feb" ~ NA_Date_,
month == "Mar" ~ NA_Date_,
TRUE ~ month)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1", part = "header",
value = as_paragraph("Some dates are missing or improperly encoded")) %>%
set_table_properties(layout = "autofit", width = .6)
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(month = case_when(month == 2 ~ NA_Date_,
month == 3 ~ NA_Date_,
TRUE ~ month)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1", part = "header",
value = as_paragraph("Some dates are missing or improperly encoded")) %>%
set_table_properties(layout = "autofit", width = .6)
cbr %>% filter(project_status == "Planned") %>%
mutate(month = month(distribution_date, label = TRUE)) %>%
group_by(month) %>%
summarise(beneficiaries = sum(beneficiaries, na.rm = TRUE)) %>%
mutate(month = case_when(month < "2023-04-31" ~ NA_Date_,
TRUE ~ month)) %>%
flextable() %>%
theme_zebra() %>%
set_caption("Planned beneficiaries by month") %>%
footnote(i = 1, j = 1, inline = TRUE, ref_symbols = "1", part = "header",
value = as_paragraph("Some dates are missing or improperly encoded")) %>%
set_table_properties(layout = "autofit", width = .6)
cbr %>% filter(project_status == "Planned") %>%
mutate(distribution_date = ifelse(distribution_date < "2023-04-31",
NA_Date_,
distribution_date))
cbr %>% filter(project_status == "Planned") %>%
mutate(distribution_date = as.POSIXct(distribution_date)) %>%
mutate(distribution_date = ifelse(distribution_date < "2023-04-31",
NA_Date_,
distribution_date))
mutate(distribution_date = as.POSIXct.Date(distribution_date)) %>%
mutate(distribution_date = ifelse(distribution_date < "2023-04-31",
NA_Date_,
distribution_date))
cbr %>% filter(project_status == "Planned") %>%
mutate(distribution_date = as.POSIXct.Date(distribution_date)) %>%
mutate(distribution_date = ifelse(distribution_date < "2023-04-31",
NA_Date_,
distribution_date))
